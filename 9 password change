Blue Team CTF: Server Parollari Oâ€˜zgartirilgan â€“ Parolni Qayta Tiklash

Agar tajovuzkorlar server parollarini oâ€˜zgartirib qoâ€˜ygan boâ€˜lsa, parollarni qayta tiklash yoki buzib kirish (password recovery) usullarini qoâ€˜llash kerak. Bu holatni Linux va Windows serverlarida qanday hal qilish mumkinligini koâ€˜rib chiqamiz.


---

1. Linux Serverda Parolni Tiklash

Agar tajovuzkor root yoki boshqa administrator hisoblarini buzgan boâ€˜lsa, quyidagi bosqichlarni bajaramiz.

1.1. Single-user Mode orqali Root Parolni Oâ€˜zgartirish

Agar serverga fizik yoki konsol orqali kirish imkoniyati boâ€˜lsa:

1ï¸âƒ£ Serverni qayta yuklash va Grub menyusida "e" tugmasini bosish
2ï¸âƒ£ Kernel satrida "ro quiet splash" ni "rw init=/bin/bash" ga oâ€˜zgartirish
3ï¸âƒ£ Ctrl+X ni bosib, root shell rejimiga oâ€˜tish
4ï¸âƒ£ Root parolni oâ€˜zgartirish:

passwd root

5ï¸âƒ£ Serverni qayta ishga tushirish:

reboot


---

1.2. Linux Shadow Faylidan Hashlarni Qayta Tiklash

Agar parol allaqachon oâ€˜zgartirilgan va tizimga kira olsak, shadow fayldan parol hashlarini chiqaramiz:

sudo cat /etc/shadow | grep root

Natija shunga oâ€˜xshash boâ€˜ladi:

root:$6$xyz$ABCD...:19315:0:99999:7:::

âœ… Parol hashini John the Ripper bilan buzish:

sudo john --wordlist=/usr/share/wordlists/rockyou.txt shadow.txt

Agar hash oddiy boâ€˜lsa, John the Ripper uni buzadi.

âœ… Hashcat yordamida buzish (GPU orqali tezroq):

hashcat -m 1800 hash.txt /usr/share/wordlists/rockyou.txt


---

1.3. SSH orqali Tiklash

Agar tajovuzkor faqat root parolni oâ€˜zgartirib, lekin boshqa foydalanuvchilarni oâ€˜zgartirmagan boâ€˜lsa:

ssh user@server

Keyin parolni root huquqlari bilan oâ€˜zgartiramiz:

sudo passwd root


---

2. Windows Serverda Parolni Tiklash

Agar Windows Server paroli oâ€˜zgartirilgan boâ€˜lsa, quyidagi usullar ishlaydi.

2.1. Offline NT Password & Registry Editor bilan Parolni Tiklash

1ï¸âƒ£ Windows Recovery Mode yoki Bootable USB orqali yuklanish
2ï¸âƒ£ Command Prompt ochish va "Utilman.exe" faylini oâ€˜zgartirish

move C:\Windows\System32\Utilman.exe C:\Windows\System32\Utilman.bak
copy C:\Windows\System32\cmd.exe C:\Windows\System32\Utilman.exe

3ï¸âƒ£ Serverni qayta ishga tushirish va Utilman (Ease of Access) tugmasini bosish
4ï¸âƒ£ Ochilgan CMD oynasida yangi parol oâ€˜rnatish

net user Administrator NewPassword

âœ… Parolni bypass qilish va yangi administrator qoâ€˜shish:

net user hacker NewPass /add
net localgroup Administrators hacker /add

Endi hacker foydalanuvchisi bilan serverga kirish mumkin.


---

2.2. Windows SAM Faylidan Hashlarni Qayta Tiklash

Agar Windows tizimida foydalanuvchi parollari saqlangan SAM fayli boâ€˜lsa:

copy C:\Windows\System32\config\SAM C:\Users\Public\
copy C:\Windows\System32\config\SYSTEM C:\Users\Public\

âœ… Hashlarni chiqarish uchun:

samdump2 SYSTEM SAM

âœ… Hashlarni buzish:

john --format=NT --wordlist=/usr/share/wordlists/rockyou.txt sam.txt


---

3. Tizimni Tozalash va Hujumni Bartaraf Etish

Agar CTF vazifasi nafaqat parolni tiklash, balki hujumni bartaraf etish boâ€˜lsa, quyidagi choralarni koâ€˜ramiz:

âœ… Tajovuzkor yaratgan foydalanuvchilarni tekshirish:

cat /etc/passwd | grep bash

Windows uchun:

net user

âœ… Shubhali rootkits yoki backdoor-larni tekshirish:

chkrootkit

âœ… Tizimga kiritilgan oâ€˜zgarishlarni tekshirish:

ls -lt /etc | head -10

âœ… Loglarni tahlil qilish (soâ€˜nggi kirishlar va sudo buyruqlar):

last -a
cat /var/log/auth.log | grep "sudo"

âœ… Parollarni murakkab qilib oâ€˜zgartirish va 2FA yoqish


---

ğŸ”´ Xulosa

1ï¸âƒ£ Linux da root parolni single-user mode orqali oâ€˜zgartirish mumkin
2ï¸âƒ£ Shadow fayldagi parol hashlarini buzish mumkin (John the Ripper, Hashcat)
3ï¸âƒ£ Windows Server da Utilman.exe bypass yoki SAM fayldan hashlarni olish orqali parolni tiklash mumkin
4ï¸âƒ£ Tajovuzkor kirganidan keyin tizimni tozalash va loglarni tekshirish kerak

Agar sizda konkret server xatoligi yoki dump fayllari boâ€˜lsa, ularni tahlil qilib berishim mumkin!

