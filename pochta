Agar bu savol **Blue Team CTF** doirasida berilgan boâ€˜lsa, demak, asosiy maqsad **shubhali elektron pochta xabarini tahlil qilish, zararli kontentni aniqlash va hujum usulini tushunish** boâ€˜ladi. Quyida **CTF yechimlariga mos keladigan** yakuniy strategiyani taqdim etaman.  

---

## **1. Xabarni olish va asosiy tekshiruv**  
CTF senariysida sizga shubhali elektron pochta `.eml` yoki `.msg` formatida berilishi mumkin. Uni ochish va tahlil qilish uchun:  

### **Linux Terminalda xabarni ochish:**  
```bash
cat email.eml
```
Yoki yanada yaxshi koâ€˜rinish uchun:
```bash
less email.eml
```

**Muhim joylar:**  
- **"From" va "Reply-To" manzillari** â€“ Manba soxta emasmi?  
- **"Received" maydoni** â€“ Xabar qaysi IP orqali kelgan?  
- **SPF, DKIM, DMARC yozuvlari** â€“ Xabar manbasi ishonchli emasmi?  
- **Phishing yoki zararli linklar** â€“ HTML kontent ichida yashiringan havolalar bormi?  
- **Zararli fayl ilovalari** â€“ `.exe`, `.js`, `.vbs`, `.docm`, `.xlsm`, `.zip` yoki `.rar` mavjudmi?  

---

## **2. Elektron pochta sarlavhalarini tahlil qilish**  
Pochta sarlavhalari (headers) orqali hujumchining asl manbasini aniqlash mumkin.  

**Sarlavhalarni chiqarish:**  
```bash
grep -i "Received:" email.eml
```
Koâ€˜p marta **"Received:"** maydonlari boâ€˜lsa, eng quyi qatordagi (birinchi server) **asl joâ€˜natuvchini** koâ€˜rsatadi.  

---

### **SPF, DKIM, DMARC tekshirish**  
- SPF tekshirish:  
  ```bash
  dig TXT example.com
  ```
  Agar **`v=spf1 -all`** koâ€˜rsatilgan boâ€˜lsa, bu domen hech qanday elektron pochta joâ€˜natmaydi.  
- DKIM tekshirish:  
  ```bash
  dig TXT default._domainkey.example.com
  ```
  Agar DKIM mavjud boâ€˜lmasa yoki notoâ€˜gâ€˜ri boâ€˜lsa, **soxta elektron pochta** boâ€˜lishi mumkin.  
- DMARC tekshirish:  
  ```bash
  dig TXT _dmarc.example.com
  ```

---

## **3. Havola va zararli kodni tahlil qilish**  
Shubhali e-mail ichidagi havolalar **HTML kod** ichida yashiringan boâ€˜lishi mumkin.  

**Barcha URL-larni chiqarish:**  
```bash
grep -o 'http[s]*://[^"]*' email.eml
```

Agar **gâ€˜alati yoki phishing domenlar** chiqsa, ularni tekshirish kerak:  
- **VirusTotal** â†’ [https://www.virustotal.com](https://www.virustotal.com)  
- **URLScan.io** â†’ [https://www.urlscan.io](https://www.urlscan.io)  
- **CheckPhish** â†’ [https://checkphish.ai](https://checkphish.ai)  

**curl orqali tekshirish:**  
```bash
curl -I http://suspicious-site.com
```
Agar sayt **302 redirect** bilan boshqa manzilga yoâ€˜naltirsa yoki **IP-manzil nomaâ€™lum** boâ€˜lsa, ehtiyot boâ€˜lish kerak.

---

## **4. Ilovalarni (attachments) tahlil qilish**  
Agar pochta xabariga ilova qilingan fayl boâ€˜lsa, uni **malware boâ€˜lishi ehtimoli** yuqori.  

**Ilovalarni chiqarish:**  
```bash
grep -i "Content-Disposition: attachment" email.eml
```

Agar `.zip`, `.docm`, `.xlsm`, `.js`, `.exe` yoki `.pdf` boâ€˜lsa, bu zararli boâ€˜lishi mumkin.  

**Faylni VirusTotalâ€™da tekshirish:**  
```bash
sha256sum suspicious_file.docx
```
Keyin **hashni** [https://www.virustotal.com](https://www.virustotal.com) ga joylashtiring.  

---

## **5. `tcpdump` orqali real vaqtdagi phishing trafigini tekshirish**  
Agar kimdir phishing linkka bosgan boâ€˜lsa, `tcpdump` orqali tarmoqdagi **shubhali HTTP yoki DNS soâ€˜rovlarini** kuzatish mumkin.  

- **HTTP GET soâ€˜rovlarini tekshirish**  
  ```bash
  sudo tcpdump -i eth0 port 80 and tcp
  ```
- **DNS soâ€˜rovlarini tekshirish (phishing sayt aniqlash uchun)**  
  ```bash
  sudo tcpdump -i eth0 port 53
  ```
- **Alohida IP-manzilga soâ€˜rovlarni tekshirish**  
  ```bash
  sudo tcpdump -i eth0 host 192.168.1.100
  ```

Agar **notanish domen yoki IP-manzil** koâ€˜rsatilsa, bu zararli sayt boâ€˜lishi mumkin.

---

## **6. MITM hujumini tekshirish (ARP Spoofing)**  
Baâ€™zan phishing hujumlari **MITM (Man-in-the-Middle)** orqali amalga oshiriladi. **ARP spoofing** aniqlash uchun:  

```bash
sudo tcpdump -i eth0 arp
```
Agar **bir xil MAC-manzil bir nechta IP-manzil uchun** qaytib kelayotgan boâ€˜lsa, ARP poisoning boâ€˜lishi mumkin.

---

## **7. Himoya choralari**  
âœ… **Shubhali domen va IP-manzillarni bloklash**  
```bash
sudo iptables -A OUTPUT -d phishing-site.com -j DROP
```
âœ… **Xodimlarni phishing va spear-phishing hujumlari haqida ogohlantirish**  
âœ… **Spam filtrlash tizimlarini yangilash (Google Workspace, Microsoft Exchange)**  
âœ… **Shubhali elektron pochtalarni sandbox muhitda tekshirish (Cuckoo Sandbox, Any.Run)**  

---

## **8. CTF kontekstida muhim boâ€˜lgan kalit maâ€™lumotlar**  
Koâ€˜p CTF-larda flag (bayroq) quyidagi formatda boâ€˜ladi:  
```
flag{something_interesting_here}
```
Bu flag **email ichida yashiringan** boâ€˜lishi mumkin:  
- **HTML kontent ichida**  
- **Attachment ichidagi EXIF maâ€™lumotlarda**  
- **Base64 encoded qismida**  

**Base64 kodlangan joylarni chiqarish uchun:**  
```bash
grep -o '[A-Za-z0-9+/=]\{20,\}' email.eml | base64 -d
```
Agar bayroq shubhali havola ichida boâ€˜lsa, **redirectlarni tekshirish** kerak:  
```bash
curl -L phishing-site.com
```

---

## **Xulosa (CTF uchun muhim yondashuv)**  
ðŸ”¹ **Pochta sarlavhalarini oâ€˜rganish va hujumchini aniqlash**  
ðŸ”¹ **Havolalar va domenlarni phishing saytlar bilan solishtirish**  
ðŸ”¹ **Malware yoki zararli makroslar borligini tekshirish**  
ðŸ”¹ **tcpdump orqali real vaqtdagi hujumlarni kuzatish**  
ðŸ”¹ **CTF flag-ni topish va submit qilish**  

Agar siz CTF uchun shubhali emailni tahlil qilayotgan boâ€˜lsangiz, **elektron pochta faylini `.eml` yoki `.msg` shaklida yuklab, ochib, flagni topishga harakat qiling!**  

Siz aynan qaysi turdagi CTF senariysida qatnashyapsiz? ðŸ¤”
