Blue Team CTF: Tajovuzkorlar Qoâ€˜lga Kiritgan Kompyuterlarga Buyruqlar Yubormoqda â€“ Hujumni Aniqlash va Bartaraf Etish

Agar tajovuzkorlar kompaniyaning tarmogâ€˜idagi kompyuterlarni boshqarishga muvaffaq boâ€˜lgan boâ€˜lsa, bu Command & Control (C2) hujumiga ishora qiladi. Ushbu hujumni aniqlash va oldini olish uchun quyidagi amallarni bajarish kerak:


---

1. C2 Trafikni Aniqlash (Network Forensics)

Tajovuzkorlar odatda PowerShell, netcat yoki boshqa vositalar orqali serverga buyruqlar yuborishadi. tcpdump yoki Wireshark yordamida shubhali trafikni tahlil qilamiz.

ğŸ›  TCPDump yordamida tarmoq trafikini yozib olish

sudo tcpdump -i eth0 -w infected_traffic.pcap

Bu tarmoqdagi barcha paketlarni .pcap formatida saqlaydi.

ğŸ“Œ Maqsadli hujum trafikini tahlil qilish

sudo tcpdump -i eth0 host 192.168.1.100

Agar 192.168.1.100 tajovuzkorlar bilan bogâ€˜langan kompyuter boâ€˜lsa, uning trafigini kuzatamiz.

âœ… Shubhali aloqalarni topish uchun:

sudo tcpdump -i eth0 port 4444 or port 8080

Metasploit yoki Netcat orqali C2 hujumi koâ€˜pincha 4444 yoki 8080 portlaridan foydalanadi.


---

2. Tajovuzkor yuborayotgan buyruqlarni aniqlash

Agar tajovuzkor PowerShell, bash yoki CMD orqali buyruqlar yuborayotgan boâ€˜lsa, biz ularni log-fayllardan topishimiz mumkin.

ğŸ“Œ Linux tizimida buyruqlar logini tekshirish

cat /var/log/auth.log | grep "session opened"
cat /var/log/syslog | grep "nc "

Agar netcat (nc) yoki boshqa ekspluatatsiya vositalari ishlatilgan boâ€˜lsa, loglar orqali topamiz.

âœ… Barcha shubhali buyruqlarni olish uchun:

cat ~/.bash_history | tail -n 50

Bu soâ€˜nggi 50 ta buyruqni koâ€˜rsatadi.


---

ğŸ“Œ Windows tizimida buyruqlar logini tekshirish

Windows tizimlarida PowerShell yoki CMD orqali joâ€˜natilgan zararli buyruqlarni Event Viewer yordamida aniqlash mumkin.

Get-WinEvent -LogName Security | Where-Object { $_.ID -eq 4688 }

Bu yaratilgan yangi jarayonlar (processlar) haqida maâ€™lumot beradi.

âœ… PowerShell loglarini koâ€˜rish:

Get-WinEvent -LogName "Microsoft-Windows-PowerShell/Operational" | Select-String "Invoke-WebRequest"

Agar tajovuzkor PowerShell orqali zararli skriptlarni yuklayotgan boâ€˜lsa, bu buyruq uni koâ€˜rsatadi.


---

3. C2 Aloqalarini Tekshirish

ğŸ“Œ Linux va Windows-da tarmoq aloqalarini tekshirish

Agar tajovuzkorlar kompyuterni C2 serverga ulab, unga buyruqlar yuborayotgan boâ€˜lsa, biz ushbu aloqalarni netstat yoki ss vositalari yordamida topishimiz mumkin.

âœ… Linux tizimida shubhali TCP sessiyalarni topish

netstat -antp | grep ESTABLISHED

Bu buyruq oâ€˜rnatilgan (ESTABLISHED) aloqalarni koâ€˜rsatadi.

âœ… Windows-da faol aloqalarni koâ€˜rish

netstat -ano | findstr ESTABLISHED

Shubhali IP manzil yoki port borligini tekshiramiz.


---

4. Jarayonlarni tekshirish va zararli faoliyatni toâ€˜xtatish

Agar tajovuzkorlar zararli dasturlarni ishga tushirgan boâ€˜lsa, biz ularni jarayonlar roâ€˜yxati (process list) orqali topamiz.

ğŸ“Œ Linux-da faol jarayonlarni tekshirish

ps aux | grep python

Koâ€˜p hollarda tajovuzkorlar Python orqali reverse shell ishga tushirishadi.

âœ… Shubhali jarayonlarni toâ€˜xtatish

kill -9 <PID>

<PID> oâ€˜rniga zararli jarayonning identifikatori (ID) yoziladi.

ğŸ“Œ Windows-da faol jarayonlarni tekshirish

Get-Process | Where-Object { $_.ProcessName -like "*powershell*" }

Agar shubhali PowerShell ishlayotgan boâ€˜lsa, uni toâ€˜xtatamiz:

Stop-Process -Id <PID> -Force


---

5. Hujumni Bartaraf Etish

âœ… Shubhali jarayonlarni toâ€˜xtatish
âœ… C2 Serverga borayotgan trafikni bloklash

sudo ufw deny out to <C2_IP>

âœ… Administrator parollarini almashtirish
âœ… Windows Defender yoki Linux ClamAV orqali zararli fayllarni tozalash

clamscan -r /home/

âœ… Xodimlarga fishing va social engineering hujumlariga qarshi trening oâ€˜tkazish


---

ğŸ”´ Xulosa: Hujumni qanday bartaraf etish kerak?

1ï¸âƒ£ Trafikni tahlil qilish (tcpdump / Wireshark / netstat)
2ï¸âƒ£ Tajovuzkor yuborgan buyruqlarni log-fayllardan topish
3ï¸âƒ£ C2 Serverga bogâ€˜langan tarmoq aloqalarini bloklash
4ï¸âƒ£ Shubhali jarayonlarni oâ€˜ldirish (kill / Stop-Process)
5ï¸âƒ£ Zararli dasturlarni topish va tizimni tozalash

âœ… Agar sizda shubhali IP-manzillar, zararli skriptlar yoki real tarmoq loglari boâ€˜lsa, ularni tahlil qilib berishim mumkin!

